# ูุฑุงุฌุนุฉ ุงูุณุงูุฏ ุจุงุฑ ูุงูุตูุงุญูุงุช - EchoOps CRM

## ๐ **ููุฎุต ุงูุชุฏููู**

ุชูุช ูุฑุงุฌุนุฉ ุดุงููุฉ ูู [`Sidebar`](file:///Users/dandouh/crm-strapi/frontend/src/components/layout/Sidebar.tsx) ูุงูุตูุญุงุช ุงููุชุงุญุฉ ููุงุจู ุงูุตูุงุญูุงุช ุงููุญุฏุฏุฉ ูู ุงูุชูุฑูุฑ.

## ๐ **ุงููุชุงุฆุฌ ุงูุฑุฆูุณูุฉ**

### โ **ุงูููุงุท ุงูุฅูุฌุงุจูุฉ:**
- ูุธุงู ุตูุงุญูุงุช ููุฌูุฏ ูููุทุจู ูู ุงูุณุงูุฏ ุจุงุฑ
- ุฌููุน ุงูุตูุญุงุช ุงูุฃุณุงุณูุฉ ููุฌูุฏุฉ ูููุนุฑููุฉ
- ุชุฑุฌูุฉ ุนุฑุจูุฉ ุดุงููุฉ ููุตูุญุงุช
- ููุชุฑุฉ ุฏููุงููููุฉ ุญุณุจ ุฏูุฑ ุงููุณุชุฎุฏู

### โ๏ธ **ุงููุดุงูู ุงูููุชุดูุฉ:**
1. **ุนุฏู ุชุทุงุจู ุฃุณูุงุก ุงูุฃุฏูุงุฑ**: ุงูุณุงูุฏ ุจุงุฑ ูุณุชุฎุฏู ุฃุณูุงุก ูุฎุชููุฉ ุนู ูุธุงู ุงูุฃุฏูุงุฑ ุงููุนูู
2. **ุตูุญุงุช ููููุฏุฉ ูู ุงูุณุงูุฏ ุจุงุฑ**: ุจุนุถ ุงูุตูุญุงุช ููุฌูุฏุฉ ูู ุงูุฑูุชุณ ููู ุบูุฑ ูุนุฑูุถุฉ
3. **ุตูุงุญูุงุช ุบูุฑ ุฏูููุฉ**: ุจุนุถ ุงูุฃุฏูุงุฑ ููุง ุตูุงุญูุงุช ุฃูุซุฑ ุฃู ุฃูู ูู ุงููุทููุจ

---

## ๐๏ธ **ููุงุฑูุฉ ุงูุตูุญุงุช: ุงูุณุงูุฏ ุจุงุฑ vs ุงูุฑูุชุณ ุงููุนููุฉ**

### ุงูุตูุญุงุช ุงูููุฌูุฏุฉ ูู ุงูุณุงูุฏ ุจุงุฑ:
| ุงูุตูุญุฉ | ุงูููุชุงุญ | ุงูุฑุงุจุท | ูุชููุฑุฉ ูู ุงูุฑูุชุณ |
|:-------|:--------|:-------|:-----------------|
| ููุญุฉ ุงูุชุญูู | `dashboard` | `/dashboard` | โ |
| ุงูุนููุงุก ุงููุญุชูููู | `leads` | `/leads` | โ |
| ุงูุนูุงุฑุงุช | `properties` | `/properties` | โ |
| ุงูุตููุงุช | `deals` | `/deals` | โ |
| ุงูุฃูุดุทุฉ | `activities` | `/activities` | โ |
| ุงูุชุญูููุงุช | `analytics` | `/analytics` | โ |
| ุงูุดุฑูุงุช | `companies` | `/companies` | โ |
| ุงูุชุณููู | `marketing` | `/marketing-campaigns` | โ |
| ูุตุงุฏุฑ ุงูุนููุงุก | `leadSources` | `/lead-sources` | โ |
| ุงููุฏููุนุงุช | `payments` | `/payments-subscriptions` | โ |
| ูุงุชุณุงุจ | `whatsapp` | `/whatsapp` | โ |
| ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช | `rolesPermissions` | `/roles-permissions` | โ |
| ุงูุชูุงุฑูุฑ | `reports` | `/advanced-reports` | โ |
| ุงููุทูุฑูู | `developers` | `/developers` | โ |
| ุงููุดุงุฑูุน | `projects` | `/projects` | โ |
| ุงูุฅุนุฏุงุฏุงุช | `settings` | `/settings` | โ |

### ุงูุตูุญุงุช ุงูููููุฏุฉ ูู ุงูุณุงูุฏ ุจุงุฑ (ููู ููุฌูุฏุฉ ูู ุงูุฑูุชุณ):
| ุงูุตูุญุฉ | ุงูุฑุงุจุท | ุงูุณุจุจ ุงููุญุชูู |
|:-------|:-------|:-------------|
| ุงูุฅุดุนุงุฑุงุช | `/notifications` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |
| ุงูุฐูุงุก ุงูุงุตุทูุงุนู | `/ai-analysis` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |
| ุงูุฃูุงู | `/security` | โ ูููุดุฑููู ููุท |
| ุงูุงุดุชุฑุงูุงุช | `/subscriptions` | โ ูููุดุฑููู ููุท |
| ุงูููุชุฑุฉ | `/billing` | โ ูููุดุฑููู ููุท |
| ุชุชุจุน ุงูุงุณุชุฎุฏุงู | `/usage-tracking` | โ ูููุดุฑููู ููุท |
| ุงูููุฒุงุช | `/feature-flags` | โ ูููุทูุฑูู ููุท |
| ุณุฌูุงุช ุงูุชุฏููู | `/audit-logs` | โ ูููุดุฑููู ููุท |
| ุงูููู ุงูุดุฎุตู | `/profile` | โ ุนุงุฏุฉ ูู Header |
| ุฅุฏุงุฑุฉ ุงููุฑู | `/teams-management` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |
| ุงูููุงู ูุงูููุงุนูุฏ | `/tasks-appointments` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |
| ุชูุตูุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู | `/ai-recommendations` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |
| ุฏูุฑุฉ ุญูุงุฉ ุงูุนููุงุก | `/lead-lifecycle` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |
| ููุญุฉ ูุงูุจุงู ููุตููุงุช | `/deals-kanban` | โ ุบูุฑ ููุถุงูุฉ ููุณุงูุฏ ุจุงุฑ |

---

## ๐ฅ **ูุฑุงุฌุนุฉ ุตูุงุญูุงุช ุงูุฃุฏูุงุฑ ูู ุงูุณุงูุฏ ุจุงุฑ**

### ๐จ **ุงููุดููุฉ ุงูุฑุฆูุณูุฉ: ุนุฏู ุชุทุงุจู ุฃุณูุงุก ุงูุฃุฏูุงุฑ**

**ุงูุฃุฏูุงุฑ ูู ุงููุธุงู ุงููุนูู:**
```typescript
export enum UserRole {
  SUPER_ADMIN = 'super_admin',        // ูุฏูุฑ ุงููุธุงู ุงูุฃุนูู
  COMPANY_ADMIN = 'company_admin',    // ูุฏูุฑ ุงูุดุฑูุฉ  
  SALES_MANAGER = 'sales_manager',    // ูุฏูุฑ ุงููุจูุนุงุช
  SALES_AGENT = 'sales_agent',        // ูููู ุงููุจูุนุงุช
  MARKETING = 'marketing',            // ุงูุชุณููู
  SUPPORT = 'support',                // ุงูุฏุนู
}
```

**ุงูุฃุฏูุงุฑ ูู ุงูุณุงูุฏ ุจุงุฑ ุงูุญุงูู:**
```typescript
const roleMap: Record<string, string[]> = {
  admin: ['dashboard','leads','properties'...],      // โ ูุฌุจ ุฃู ูููู 'super_admin'
  manager: ['dashboard','leads','properties'...],    // โ ุบูุฑ ูุงุถุญ - ุฃู ูุฏูุฑุ
  agent: ['dashboard','leads','properties'...],      // โ ูุฌุจ ุฃู ูููู 'sales_agent'
  user: ['dashboard','activities','settings']        // โ ูุง ููุฌุฏ ุฏูุฑ 'user' ูู ุงููุธุงู
};
```

### **ุตูุงุญูุงุช ุงูุณุงูุฏ ุจุงุฑ ุงูุญุงููุฉ:**

#### Admin (ูููุชุฑุถ Super Admin):
โ **ุตุญูุญ**: ูุตูู ูุฌููุน ุงูุตูุญุงุช
- `dashboard`, `leads`, `properties`, `deals`, `activities`, `analytics`, `companies`, `marketing`, `leadSources`, `payments`, `whatsapp`, `rolesPermissions`, `reports`, `developers`, `projects`, `settings`

#### Manager (ุบูุฑ ูุงุถุญ - ุฃู ูุฏูุฑุ):
โ๏ธ **ูุดููู**: ููููุฏุฉ ุตูุญุงุช ูููุฉ
- ุงูููุฌูุฏ: `dashboard`, `leads`, `properties`, `deals`, `activities`, `analytics`, `companies`, `marketing`, `leadSources`, `whatsapp`, `developers`, `projects`, `settings`
- **ุงูููููุฏ**: `payments`, `rolesPermissions`, `reports` (ูููุฏูุฑูู ุงููุฎูููู)

#### Agent (ูููุชุฑุถ Sales Agent):
โ๏ธ **ุฒุงุฆุฏ ุนู ุงููุทููุจ**: ูุตูู ูุตูุญุงุช ูุง ูุฌุจ ุฃู ูุฑุงูุง
- ุงูููุฌูุฏ: `dashboard`, `leads`, `properties`, `deals`, `activities`, `whatsapp`, `developers`, `projects`, `settings`
- **ุงูุฒุงุฆุฏ**: `companies`, `analytics`, `marketing`, `leadSources` (ูุง ูุฌุจ ุฃู ูุฑุงูุง Sales Agent)
- **ุงูููููุฏ**: ูุง ุดูุก ุญุณุจ ุงูุชูุฑูุฑ

#### User (ุฏูุฑ ุบูุฑ ููุฌูุฏ):
โ **ุฎุทุฃ**: ูุง ููุฌุฏ ุฏูุฑ "user" ูู ุงููุธุงู
- ุงูููุฌูุฏ: `dashboard`, `activities`, `settings`

### **ุงูุตูุงุญูุงุช ุงููุทููุจุฉ ุญุณุจ ุงูุชูุฑูุฑ:**

#### Super Admin:
โ **ุฌููุน ุงูุตูุญุงุช** (ูุทุงุจู ููุญุงูู)

#### Company Admin:
โ **ูุนุธู ุงูุตูุญุงุช** + ุตูุญุงุช ุฅุฏุงุฑูุฉ:
- ูู ุดูุก ูุง ุนุฏุง ุงูุตูุญุงุช ุงูุฎุงุตุฉ ุจู Super Admin ููุท
- ูุฌุจ ุฅุถุงูุฉ: `notifications`, `ai-analysis`, `audit-logs`

#### Sales Manager:
๐ **ุตูุญุงุช ุงููุจูุนุงุช** + ุฅุฏุงุฑุฉ ุงููุฑูู:
- `dashboard`, `leads`, `properties`, `deals`, `activities`, `analytics`, `reports`, `developers`, `projects`, `settings`
- ูุฌุจ ุฅุถุงูุฉ: `teams-management` (ุฅุฏุงุฑุฉ ุงููุฑูู)

#### Sales Agent:
๐ฏ **ุตูุญุงุช ุงูุนูู ุงูุฃุณุงุณูุฉ** ููุท:
- `dashboard`, `leads`, `properties`, `deals`, `activities`, `developers`, `projects`, `settings`
- ูุฌุจ ุฅุฒุงูุฉ: `companies`, `analytics`, `marketing`, `leadSources`, `whatsapp`

#### Marketing:
๐ **ุตูุญุงุช ุงูุชุณููู** + ุงูุนููุงุก:
- `dashboard`, `leads`, `properties`, `marketing`, `leadSources`, `analytics`, `reports`, `ai-analysis`, `settings`
- ูุฌุจ ุฅุถุงูุฉ: `ai-analysis`, `lead-lifecycle`

#### Support:
๐๏ธ **ูุฑุงุกุฉ ููุท** ูุฃุบุฑุงุถ ุงูุฏุนู:
- `dashboard`, `leads`, `properties`, `deals`, `activities`, `developers`, `projects`, `settings`
- ูู ุดูุก **ูููุฑุงุกุฉ ููุท**

---

## ๐ง **ุงูุฅุตูุงุญุงุช ุงููุทููุจุฉ**

### 1. **ุชุตุญูุญ ุฃุณูุงุก ุงูุฃุฏูุงุฑ ูู ุงูุณุงูุฏ ุจุงุฑ:**

```typescript
// ูุจู ุงูุชุตุญูุญ โ
const roleMap: Record<string, string[]> = {
  admin: [...],
  manager: [...],
  agent: [...],
  user: [...]
};

// ุจุนุฏ ุงูุชุตุญูุญ โ
const roleMap: Record<string, string[]> = {
  super_admin: [...],
  company_admin: [...], 
  sales_manager: [...],
  sales_agent: [...],
  marketing: [...],
  support: [...]
};
```

### 2. **ุฅุถุงูุฉ ุงูุตูุญุงุช ุงูููููุฏุฉ ููุณุงูุฏ ุจุงุฑ:**

```typescript
const allItems = [
  // ... ุงูุตูุญุงุช ุงูููุฌูุฏุฉ
  
  // ุตูุญุงุช ููููุฏุฉ ูููุฉ:
  { key: 'notifications', href: '/notifications', icon: Bell, label: t('nav.notifications') },
  { key: 'aiAnalysis', href: '/ai-analysis', icon: Brain, label: t('nav.ai') },
  { key: 'teams', href: '/teams-management', icon: Users, label: t('nav.teams') },
  { key: 'tasks', href: '/tasks-appointments', icon: Calendar, label: t('nav.tasks') },
  { key: 'auditLogs', href: '/audit-logs', icon: FileText, label: t('nav.auditLogs') },
  { key: 'security', href: '/security', icon: Shield, label: t('nav.security') },
];
```

### 3. **ุชุญุฏูุซ ุตูุงุญูุงุช ุงูุฃุฏูุงุฑ:**

```typescript
const roleMap: Record<string, string[]> = {
  super_admin: [
    // ุฌููุน ุงูุตูุญุงุช
    'dashboard','leads','properties','deals','activities','analytics','companies',
    'marketing','leadSources','payments','whatsapp','rolesPermissions','reports',
    'developers','projects','notifications','aiAnalysis','security','auditLogs',
    'subscriptions','billing','usageTracking','featureFlags','settings'
  ],
  
  company_admin: [
    // ูู ุดูุก ูุง ุนุฏุง ุตูุญุงุช Super Admin ุงูุฎุงุตุฉ
    'dashboard','leads','properties','deals','activities','analytics','companies',
    'marketing','leadSources','payments','whatsapp','rolesPermissions','reports',
    'developers','projects','notifications','aiAnalysis','auditLogs','settings'
  ],
  
  sales_manager: [
    // ุฅุฏุงุฑุฉ ุงููุจูุนุงุช ูุงููุฑูู
    'dashboard','leads','properties','deals','activities','analytics','reports',
    'developers','projects','teams','notifications','settings'
  ],
  
  sales_agent: [
    // ุงูุนูู ุงูุฃุณุงุณู ููุท
    'dashboard','leads','properties','deals','activities','developers','projects',
    'notifications','settings'
  ],
  
  marketing: [
    // ุงูุชุณููู ูุงูุชุญูููุงุช
    'dashboard','leads','properties','marketing','leadSources','analytics',
    'reports','aiAnalysis','leadLifecycle','notifications','settings'
  ],
  
  support: [
    // ูุฑุงุกุฉ ููุท ููุฏุนู
    'dashboard','leads','properties','deals','activities','developers','projects',
    'notifications','settings'
  ]
};
```

### 4. **ุฅุถุงูุฉ ุชุญูู ูู ุงูุตูุงุญูุงุช:**

```typescript
import { usePermissions } from '@/hooks/usePermissions';

export const Sidebar: React.FC = () => {
  const { can, hasRole } = usePermissions();
  
  // ููุชุฑุฉ ุงูุตูุญุงุช ุญุณุจ ุงูุตูุงุญูุงุช ุงููุนููุฉ
  const menuItems = allItems.filter(item => {
    // ุชุญูู ูู ุงูุตูุงุญูุงุช ุงููุทููุจุฉ ููู ุตูุญุฉ
    switch(item.key) {
      case 'rolesPermissions':
        return can('users.create') || hasRole('company_admin');
      case 'payments':
        return can('payments.read');
      case 'auditLogs':
        return can('audit.read');
      // ... ุฅูุฎ
      default:
        return allowedKeys.includes(item.key);
    }
  });
};
```

---

## โ **ุฎุทุฉ ุงูุชูููุฐ**

### ุงููุฑุญูุฉ 1: ุฅุตูุงุญ ุงูุฃุฏูุงุฑ (ุฃููููุฉ ุนุงููุฉ)
1. ุชุตุญูุญ ุฃุณูุงุก ุงูุฃุฏูุงุฑ ูู ุงูุณุงูุฏ ุจุงุฑ
2. ุชุญุฏูุซ ููุทู ููุชุฑุฉ ุงูุตูุญุงุช
3. ุงุฎุชุจุงุฑ ูุน ุงูุฃุฏูุงุฑ ุงูุญููููุฉ

### ุงููุฑุญูุฉ 2: ุฅุถุงูุฉ ุงูุตูุญุงุช ุงูููููุฏุฉ (ุฃููููุฉ ูุชูุณุทุฉ)
1. ุฅุถุงูุฉ ุงูุฅุดุนุงุฑุงุช ููุณุงูุฏ ุจุงุฑ
2. ุฅุถุงูุฉ ุตูุญุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู
3. ุฅุถุงูุฉ ุตูุญุงุช ุฅุฏุงุฑุฉ ุงููุฑู

### ุงููุฑุญูุฉ 3: ุชุญุณูู ุงูุตูุงุญูุงุช (ุฃููููุฉ ูุชูุณุทุฉ)
1. ุฑุจุท ุงูุณุงูุฏ ุจุงุฑ ุจูุธุงู ุงูุตูุงุญูุงุช ุงููุนูู
2. ุฅุถุงูุฉ ุชุญูู ุฏููุงูููู ูู ุงูุตูุงุญูุงุช
3. ุฅุฎูุงุก/ุฅุธูุงุฑ ุงูุตูุญุงุช ุจูุงุกู ุนูู ุตูุงุญูุงุช ุญููููุฉ

### ุงููุฑุญูุฉ 4: ุงุฎุชุจุงุฑ ุดุงูู (ุฃููููุฉ ุนุงููุฉ)
1. ุงุฎุชุจุงุฑ ุฌููุน ุงูุฃุฏูุงุฑ
2. ุงูุชุฃูุฏ ูู ุนูู ุฌููุน ุงูุฑูุงุจุท
3. ุงุฎุชุจุงุฑ ุงูุตูุงุญูุงุช ุงูููุญุฏุซุฉ

---

## ๐ **ุงูุฎูุงุตุฉ ูุงูุชูุตูุงุช**

### **ุงูููุงุท ุงูุฅูุฌุงุจูุฉ:**
- โ ูุธุงู ุณุงูุฏ ุจุงุฑ ูุฑู ููุงุจู ููุชุฎุตูุต
- โ ุชุฑุฌูุฉ ุดุงููุฉ ููุตูุญุงุช
- โ ุฌููุน ุงูุตูุญุงุช ุงูุฃุณุงุณูุฉ ููุฌูุฏุฉ

### **ุงููุดุงูู ุงูุญุฑุฌุฉ:**
- ๐จ ุนุฏู ุชุทุงุจู ุฃุณูุงุก ุงูุฃุฏูุงุฑ (ูุญุชุงุฌ ุฅุตูุงุญ ููุฑู)
- โ๏ธ ุตูุญุงุช ูููุฉ ููููุฏุฉ ูู ุงูุณุงูุฏ ุจุงุฑ
- โ๏ธ ุตูุงุญูุงุช ุบูุฑ ุฏูููุฉ ูุจุนุถ ุงูุฃุฏูุงุฑ

### **ุงูุชูุตูุงุช:**
1. **ุฅุตูุงุญ ููุฑู** ูุฃุณูุงุก ุงูุฃุฏูุงุฑ
2. **ุฅุถุงูุฉ ุงูุตูุญุงุช ุงูููููุฏุฉ** ุงููููุฉ
3. **ุฑุจุท ุงูุณุงูุฏ ุจุงุฑ ุจูุธุงู ุงูุตูุงุญูุงุช ุงูุญูููู**
4. **ุงุฎุชุจุงุฑ ุดุงูู** ูุฌููุน ุงูุฃุฏูุงุฑ

---

**ุงูุญุงูุฉ ุงูุนุงูุฉ**: ๐ก **ูุญุชุงุฌ ุชุญุณูู** - ุงููุธุงู ูุนูู ููู ูุญุชุงุฌ ุฅุตูุงุญุงุช ูููุฉ ูุชุทุงุจู ุงููุชุทูุจุงุช ุจุฏูุฉ.