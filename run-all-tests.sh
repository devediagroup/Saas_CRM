#!/bin/bash

# ๐งช EchoOps CRM - ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
echo "๐งช ุจุฏุก ุชุดุบูู ุฌููุน ุงุฎุชุจุงุฑุงุช EchoOps CRM..."

# ุงูุชุญูู ูู ูุฌูุฏ Node.js
if ! command -v node &> /dev/null; then
    echo "โ ุฎุทุฃ: Node.js ุบูุฑ ูุซุจุช"
    exit 1
fi

echo "โ Node.js $(node -v) ูุซุจุช"

# ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (Backend)
echo ""
echo "๐ ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (Backend)..."
cd backend
npm run test
if [ $? -ne 0 ]; then
    echo "โ ูุดูุช ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ"
    exit 1
fi
echo "โ ุชู ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ ุจูุฌุงุญ"

# ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู (Backend)
echo ""
echo "๐ ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู (Backend)..."
npm run test:e2e
if [ $? -ne 0 ]; then
    echo "โ ูุดูุช ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู"
    exit 1
fi
echo "โ ุชู ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู ุจูุฌุงุญ"

# ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู (Backend)
echo ""
echo "๐ ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู (Backend)..."
npm run test:security
if [ $? -ne 0 ]; then
    echo "โ ูุดูุช ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู"
    exit 1
fi
echo "โ ุชู ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู ุจูุฌุงุญ"

cd ..

# ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงูููุงูุฉ ุฅูู ุงูููุงูุฉ (Frontend)
echo ""
echo "๐ ุงุฎุชุจุงุฑุงุช ุงูููุงูุฉ ุฅูู ุงูููุงูุฉ (Frontend)..."
cd frontend
npm run test:e2e
if [ $? -ne 0 ]; then
    echo "โ ูุดูุช ุงุฎุชุจุงุฑุงุช ุงูููุงูุฉ ุฅูู ุงูููุงูุฉ"
    exit 1
fi
echo "โ ุชู ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงูููุงูุฉ ุฅูู ุงูููุงูุฉ ุจูุฌุงุญ"

cd ..

echo ""
echo "๐ ุชู ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ุจูุฌุงุญ!"
echo ""
echo "๐ ููุฎุต ุงููุชุงุฆุฌ:"
echo "  โ ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (Backend)"
echo "  โ ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู (Backend)"
echo "  โ ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู (Backend)"
echo "  โ ุงุฎุชุจุงุฑุงุช ุงูููุงูุฉ ุฅูู ุงูููุงูุฉ (Frontend)"
echo ""
echo "๐ ุงููุธุงู ุฌุงูุฒ ููุฅูุชุงุฌ!"
